<!DOCTYPE html>
<html>
<head>
	<title>Doodle</title>
	<script type="text/javascript" src="dist/doodle-latest.js"></script>
	<link rel="stylesheet" type="text/css" href="doodle.css">
</head>
<body>
	<div id="presetEditor">
		<div id="renderArea"></div>
		<div id="propertyGroup" style="overflow: auto">
			<div id="propertyGrid"></div>
		</div>
	</div>
	<script type="text/javascript">
		function getURLParameter(name) {
			return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null;
		}

		var editor = new PresetEditor('presetEditor', 'propertyGrid', 'renderArea');
		editor.addAppType('Whitney', Whitney);
		editor.addAppType('LineFuck', LineFuck);

		let appType = getURLParameter('type');
		if (appType) {
			editor.app = appType;

			let settings = { app: {}, mod: {} };

			let props = editor.preset.schema.properties;
			for (let key in props) {
				let prop = props[key];
				let val = getURLParameter('a.' + key);
				if (val !== null) {
					if (prop.type === 'number') {
						val = parseFloat(val);
					} else if (prop.type === 'boolean') {
						val = val === 'true';
					}

					settings.app[key] = val;
				}
			}

			props = editor._modSchema;
			for (let key in props) {
				let prop = props[key];
				let val = getURLParameter('m.' + key);
				if (val !== null) {
					if (prop.type === 'number') {
						val = parseFloat(val);
					} else if (prop.type === 'boolean') {
						val = val === 'true';
					}

					settings.mod[key] = val;
				}
			}

			editor.loadPreset(settings);
		} else {
			editor.app = new Whitney();
		}

		editor.run();
	</script>
</body>
</html>